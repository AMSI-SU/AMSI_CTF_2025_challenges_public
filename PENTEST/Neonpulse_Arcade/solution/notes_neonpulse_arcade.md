# Neonpulse Arcade - Ubuntu Box

# Easy connection
```bash
ssh synthkid@192.168.160.136 -i id_rsa_synthkid

# IP
192.168.160.136
```

# Passwords
```bash
echo 'root:sup3rc0mpliqueLepassw0rdOuiJet@ssurequilestCOMPL3X3!!' | chpasswd
echo 'synthkid:R3tr0W4v3_M4st3r!' | chpasswd
```

# Flags
```bash
# Flag protection
chattr +i ./flag
# Pour retirer la protection
chattr -i ./flag

# Root Flag

# User Flag

```

# TODO
- Attention a ne pas creer un user arcadmin avec le mm mot de passe en ssh car ca casse tout
- Mettre des mots de passe compliqué pour root et synthkid. (Actuellement "p"...)
- Interdire tous les dossiers fichiers, sauf ce qu'il faut dans apache a part le .git !

# Configuration de la machine virtuelle

## Apache
```bash
/etc/apache2/sites-available/dev-upload-game.conf :

<VirtualHost *:80>
    ServerName dev-upload-game.neonpulse.local
    DocumentRoot /var/www/html/dev-upload-game

    <Directory /var/www/html/dev-upload-game>
        AllowOverride All
        Require all granted
    </Directory>

    # Redirige les accès par IP vers le nom de domaine
    RewriteEngine On
    RewriteCond %{HTTP_HOST} !^dev-upload-game\.neonpulse\.local$ [NC]
    RewriteRule ^(.*)$ http://dev-upload-game.neonpulse.local/$1 [R=301,L]
</VirtualHost>

/etc/apache2/sites-available/neonpulse.conf

<VirtualHost *:80>
    ServerName neonpulse.local
    DocumentRoot /var/www/html/neonpulse

    <Directory /var/www/html/neonpulse>
        AllowOverride All
        Require all granted
    </Directory>

    # Redirige les accès par IP vers le nom de domaine
    RewriteEngine On
    RewriteCond %{HTTP_HOST} !^neonpulse\.local$ [NC]
    RewriteRule ^(.*)$ http://neonpulse.local/$1 [R=301,L]
</VirtualHost>
```

Activer les modules et sites necessaires :

```bash
sudo a2enmod rewrite
sudo a2ensite dev-upload-game.conf
sudo a2ensite neonpulse.conf
sudo systemctl reload apache2
```

Emepecher l'acces via IP :
```bash
sudo a2dissite 000-default.conf
sudo systemctl reload apache2
```

# delete synthkid from sudoers
deluser synthkid sudo

# Solution

## dirsearch, gobuster
```bash

```

## git-dumper: getting source code website
```bash
pip install git-dumper
git-dumper http://localhost/box1/website .
```

### Discovering fake db_connect.php searching in commits

### Discovering LFI in source code

## LFI - highscores

### Discovering subdomain admin using LFI

## Using Password db_connect.php to connect to admin page

## Zip exploit
2 options :
- Showing the output that the zip is extracted, so the attacker can understand that a command can be executed if name of zip is a command
- upload a .bak file with the source code, but not showing that the zip is extracted after an upload

## Upload a fake zip with command in name

## From www-data to synthkid -> password re-use

## Exploit SUID score_validator synthkid -> root