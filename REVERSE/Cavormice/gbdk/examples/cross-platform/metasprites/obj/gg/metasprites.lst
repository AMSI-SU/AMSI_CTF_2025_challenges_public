                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler 
                                      3 ; Version 4.4.1 #14650 (Linux)
                                      4 ;--------------------------------------------------------
                                      5 	.module metasprites
                                      6 	.optsdcc -mz80
                                      7 	
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _main
                                     12 	.globl _load_and_duplicate_sprite_tile_data
                                     13 	.globl _get_tile_offset
                                     14 	.globl _set_tile
                                     15 	.globl _hide_sprites_range
                                     16 	.globl _fill_rect_compat
                                     17 	.globl _set_tile_2bpp_data
                                     18 	.globl _joypad
                                     19 	.globl _vsync
                                     20 	.globl _old_joyp
                                     21 	.globl _joyp
                                     22 	.globl _num_tiles
                                     23 	.globl _flipped_data
                                     24 	.globl _rot
                                     25 	.globl _idx
                                     26 	.globl _PosF
                                     27 	.globl _SpdY
                                     28 	.globl _SpdX
                                     29 	.globl _PosY
                                     30 	.globl _PosX
                                     31 	.globl _green_pal
                                     32 	.globl _cyan_pal
                                     33 	.globl _pink_pal
                                     34 	.globl _gray_pal
                                     35 	.globl _reverse_bits
                                     36 	.globl _pattern
                                     37 ;--------------------------------------------------------
                                     38 ; special function registers
                                     39 ;--------------------------------------------------------
                         00000000    40 _GG_STATE	=	0x0000
                         00000001    41 _GG_EXT_7BIT	=	0x0001
                         00000002    42 _GG_EXT_CTL	=	0x0002
                         00000003    43 _GG_SIO_SEND	=	0x0003
                         00000004    44 _GG_SIO_RECV	=	0x0004
                         00000005    45 _GG_SIO_CTL	=	0x0005
                         00000006    46 _GG_SOUND_PAN	=	0x0006
                         0000003E    47 _MEMORY_CTL	=	0x003e
                         0000003F    48 _JOY_CTL	=	0x003f
                         0000007E    49 _VCOUNTER	=	0x007e
                         0000007F    50 _PSG	=	0x007f
                         0000007F    51 _HCOUNTER	=	0x007f
                         000000BE    52 _VDP_DATA	=	0x00be
                         000000BF    53 _VDP_CMD	=	0x00bf
                         000000BF    54 _VDP_STATUS	=	0x00bf
                         000000DC    55 _JOY_PORT1	=	0x00dc
                         000000DD    56 _JOY_PORT2	=	0x00dd
                         000000F0    57 _FMADDRESS	=	0x00f0
                         000000F1    58 _FMDATA	=	0x00f1
                         000000F2    59 _AUDIOCTRL	=	0x00f2
                                     60 ;--------------------------------------------------------
                                     61 ; ram data
                                     62 ;--------------------------------------------------------
                                     63 	.area _DATA
                         0000FFFC    64 _RAM_CONTROL	=	0xfffc
                         0000FFF8    65 _GLASSES_3D	=	0xfff8
                         0000FFFD    66 _MAP_FRAME0	=	0xfffd
                         0000FFFE    67 _MAP_FRAME1	=	0xfffe
                         0000FFFF    68 _MAP_FRAME2	=	0xffff
    00000000                         69 _PosX::
    00000000                         70 	.ds 2
    00000002                         71 _PosY::
    00000002                         72 	.ds 2
    00000004                         73 _SpdX::
    00000004                         74 	.ds 2
    00000006                         75 _SpdY::
    00000006                         76 	.ds 2
    00000008                         77 _PosF::
    00000008                         78 	.ds 1
    00000009                         79 _idx::
    00000009                         80 	.ds 1
    0000000A                         81 _rot::
    0000000A                         82 	.ds 1
    0000000B                         83 _flipped_data::
    0000000B                         84 	.ds 16
    0000001B                         85 _num_tiles::
    0000001B                         86 	.ds 2
                                     87 ;--------------------------------------------------------
                                     88 ; ram data
                                     89 ;--------------------------------------------------------
                                     90 	.area _INITIALIZED
    00000000                         91 _joyp::
    00000000                         92 	.ds 1
    00000001                         93 _old_joyp::
    00000001                         94 	.ds 1
                                     95 ;--------------------------------------------------------
                                     96 ; absolute external ram data
                                     97 ;--------------------------------------------------------
                                     98 	.area _DABS (ABS)
                                     99 ;--------------------------------------------------------
                                    100 ; global & static initialisations
                                    101 ;--------------------------------------------------------
                                    102 	.area _HOME
                                    103 	.area _GSINIT
                                    104 	.area _GSFINAL
                                    105 	.area _GSINIT
                                    106 ;--------------------------------------------------------
                                    107 ; Home
                                    108 ;--------------------------------------------------------
                                    109 	.area _HOME
                                    110 	.area _HOME
                                    111 ;--------------------------------------------------------
                                    112 ; code
                                    113 ;--------------------------------------------------------
                                    114 	.area _CODE
                                    115 ;src/metasprites.c:94: void set_tile(uint8_t tile_idx, uint8_t* data, uint8_t flip_x, uint8_t flip_y)
                                    116 ;	---------------------------------
                                    117 ; Function set_tile
                                    118 ; ---------------------------------
    00000000                        119 _set_tile::
    00000000 DD E5            [15]  120 	push	ix
    00000002 DD 21 00 00      [14]  121 	ld	ix,#0
    00000006 DD 39            [15]  122 	add	ix,sp
    00000008 21 F9 FF         [10]  123 	ld	hl, #-7
    0000000B 39               [11]  124 	add	hl, sp
    0000000C F9               [ 6]  125 	ld	sp, hl
    0000000D DD 77 FD         [19]  126 	ld	-3 (ix), a
    00000010 DD 73 FB         [19]  127 	ld	-5 (ix), e
    00000013 DD 72 FC         [19]  128 	ld	-4 (ix), d
                                    129 ;src/metasprites.c:97: for(i = 0; i < TILE_HEIGHT; i++)
    00000016 AF               [ 4]  130 	xor	a, a
    00000017 DD 77 FE         [19]  131 	ld	-2 (ix), a
    0000001A DD 77 FF         [19]  132 	ld	-1 (ix), a
    0000001D                        133 00103$:
                                    134 ;src/metasprites.c:99: size_t y = flip_y ? (TILE_HEIGHT-1-i) : i; 
    0000001D DD 7E 05         [19]  135 	ld	a, 5 (ix)
    00000020 B7               [ 4]  136 	or	a, a
    00000021 28 11            [12]  137 	jr	Z, 00107$
    00000023 3E 07            [ 7]  138 	ld	a, #0x07
    00000025 DD 96 FE         [19]  139 	sub	a, -2 (ix)
    00000028 DD 77 F9         [19]  140 	ld	-7 (ix), a
    0000002B 9F               [ 4]  141 	sbc	a, a
    0000002C DD 96 FF         [19]  142 	sub	a, -1 (ix)
    0000002F DD 77 FA         [19]  143 	ld	-6 (ix), a
    00000032 18 0A            [12]  144 	jr	00108$
    00000034                        145 00107$:
    00000034 DD 7E FE         [19]  146 	ld	a, -2 (ix)
    00000037 DD 77 F9         [19]  147 	ld	-7 (ix), a
    0000003A DD 36 FA 00      [19]  148 	ld	-6 (ix), #0x00
    0000003E                        149 00108$:
    0000003E D1               [10]  150 	pop	de
    0000003F D5               [11]  151 	push	de
                                    152 ;src/metasprites.c:100: flipped_data[2*i] = flip_x ? reverse_bits[data[2*y]] : data[2*y];
    00000040 DD 7E FE         [19]  153 	ld	a, -2 (ix)
    00000043 87               [ 4]  154 	add	a, a
    00000044 4F               [ 4]  155 	ld	c, a
    00000045 6F               [ 4]  156 	ld	l, a
                                    157 ;	spillPairReg hl
                                    158 ;	spillPairReg hl
    00000046 07               [ 4]  159 	rlca
    00000047 9F               [ 4]  160 	sbc	a, a
    00000048 67               [ 4]  161 	ld	h, a
                                    162 ;	spillPairReg hl
                                    163 ;	spillPairReg hl
    00000049 3Er0B            [ 7]  164 	ld	a, #<(_flipped_data)
    0000004B 85               [ 4]  165 	add	a, l
    0000004C DD 77 F9         [19]  166 	ld	-7 (ix), a
    0000004F 3Es00            [ 7]  167 	ld	a, #>(_flipped_data)
    00000051 8C               [ 4]  168 	adc	a, h
    00000052 DD 77 FA         [19]  169 	ld	-6 (ix), a
    00000055 EB               [ 4]  170 	ex	de, hl
    00000056 29               [11]  171 	add	hl, hl
    00000057 EB               [ 4]  172 	ex	de, hl
    00000058 DD 6E FB         [19]  173 	ld	l, -5 (ix)
                                    174 ;	spillPairReg hl
                                    175 ;	spillPairReg hl
    0000005B DD 66 FC         [19]  176 	ld	h, -4 (ix)
                                    177 ;	spillPairReg hl
                                    178 ;	spillPairReg hl
    0000005E 19               [11]  179 	add	hl, de
    0000005F 46               [ 7]  180 	ld	b, (hl)
    00000060 DD 7E 04         [19]  181 	ld	a, 4 (ix)
    00000063 B7               [ 4]  182 	or	a, a
    00000064 28 0A            [12]  183 	jr	Z, 00109$
    00000066 3ErD9            [ 7]  184 	ld	a, #<(_reverse_bits)
    00000068 80               [ 4]  185 	add	a, b
    00000069 6F               [ 4]  186 	ld	l, a
                                    187 ;	spillPairReg hl
                                    188 ;	spillPairReg hl
    0000006A 3Es00            [ 7]  189 	ld	a, #>(_reverse_bits)
    0000006C CE 00            [ 7]  190 	adc	a, #0x00
    0000006E 67               [ 4]  191 	ld	h, a
                                    192 ;	spillPairReg hl
                                    193 ;	spillPairReg hl
    0000006F 46               [ 7]  194 	ld	b, (hl)
    00000070                        195 00109$:
    00000070 E1               [10]  196 	pop	hl
    00000071 E5               [11]  197 	push	hl
    00000072 70               [ 7]  198 	ld	(hl), b
                                    199 ;src/metasprites.c:101: flipped_data[2*i+1] = flip_x ? reverse_bits[data[2*y+1]] : data[2*y+1];
    00000073 0C               [ 4]  200 	inc	c
    00000074 79               [ 4]  201 	ld	a, c
    00000075 07               [ 4]  202 	rlca
    00000076 9F               [ 4]  203 	sbc	a, a
    00000077 47               [ 4]  204 	ld	b, a
    00000078 21r0Br00         [10]  205 	ld	hl, #_flipped_data
    0000007B 09               [11]  206 	add	hl, bc
    0000007C 4D               [ 4]  207 	ld	c, l
    0000007D 44               [ 4]  208 	ld	b, h
    0000007E 13               [ 6]  209 	inc	de
    0000007F DD 6E FB         [19]  210 	ld	l, -5 (ix)
                                    211 ;	spillPairReg hl
                                    212 ;	spillPairReg hl
    00000082 DD 66 FC         [19]  213 	ld	h, -4 (ix)
                                    214 ;	spillPairReg hl
                                    215 ;	spillPairReg hl
    00000085 19               [11]  216 	add	hl, de
    00000086 5E               [ 7]  217 	ld	e, (hl)
    00000087 DD 7E 04         [19]  218 	ld	a, 4 (ix)
    0000008A B7               [ 4]  219 	or	a, a
    0000008B 28 09            [12]  220 	jr	Z, 00111$
    0000008D 21rD9r00         [10]  221 	ld	hl, #_reverse_bits
    00000090 16 00            [ 7]  222 	ld	d, #0x00
    00000092 19               [11]  223 	add	hl, de
    00000093 7E               [ 7]  224 	ld	a, (hl)
    00000094 18 01            [12]  225 	jr	00112$
    00000096                        226 00111$:
    00000096 7B               [ 4]  227 	ld	a, e
    00000097                        228 00112$:
    00000097 02               [ 7]  229 	ld	(bc), a
                                    230 ;src/metasprites.c:97: for(i = 0; i < TILE_HEIGHT; i++)
    00000098 DD 34 FE         [23]  231 	inc	-2 (ix)
    0000009B 20 03            [12]  232 	jr	NZ, 00149$
    0000009D DD 34 FF         [23]  233 	inc	-1 (ix)
    000000A0                        234 00149$:
    000000A0 DD 7E FE         [19]  235 	ld	a, -2 (ix)
    000000A3 D6 08            [ 7]  236 	sub	a, #0x08
    000000A5 3E 00            [ 7]  237 	ld	a, #0x00
    000000A7 DE 00            [ 7]  238 	sbc	a, #0x00
    000000A9 DAr1Dr00         [10]  239 	jp	C, 00103$
                                    240 ;src/metasprites.c:103: set_sprite_data(tile_idx, 1, flipped_data);
    000000AC 01r0Br00         [10]  241 	ld	bc, #_flipped_data
    000000AF DD 5E FD         [19]  242 	ld	e, -3 (ix)
                                    243 ;../../../include/sms/sms.h:636: set_tile_2bpp_data((uint8_t)(start) + 0x100u, ntiles, src, _current_2bpp_palette);
                                    244 ;	spillPairReg hl
                                    245 ;	spillPairReg hl
    000000B2 AF               [ 4]  246 	xor	a, a
    000000B3 3C               [ 4]  247 	inc	a
    000000B4 57               [ 4]  248 	ld	d, a
    000000B5 2Ar00r00         [16]  249 	ld	hl, (__current_2bpp_palette)
    000000B8 E5               [11]  250 	push	hl
    000000B9 C5               [11]  251 	push	bc
    000000BA 21 01 00         [10]  252 	ld	hl, #0x0001
    000000BD E5               [11]  253 	push	hl
    000000BE D5               [11]  254 	push	de
    000000BF CDr00r00         [17]  255 	call	_set_tile_2bpp_data
                                    256 ;src/metasprites.c:103: set_sprite_data(tile_idx, 1, flipped_data);
                                    257 ;src/metasprites.c:104: }
    000000C2 DD F9            [10]  258 	ld	sp, ix
    000000C4 DD E1            [14]  259 	pop	ix
    000000C6 E1               [10]  260 	pop	hl
    000000C7 F1               [10]  261 	pop	af
    000000C8 E9               [ 4]  262 	jp	(hl)
    000000C9                        263 _pattern:
    000000C9 80                     264 	.db #0x80	; 128
    000000CA 80                     265 	.db #0x80	; 128
    000000CB 40                     266 	.db #0x40	; 64
    000000CC 40                     267 	.db #0x40	; 64
    000000CD 20                     268 	.db #0x20	; 32
    000000CE 20                     269 	.db #0x20	; 32
    000000CF 10                     270 	.db #0x10	; 16
    000000D0 10                     271 	.db #0x10	; 16
    000000D1 08                     272 	.db #0x08	; 8
    000000D2 08                     273 	.db #0x08	; 8
    000000D3 04                     274 	.db #0x04	; 4
    000000D4 04                     275 	.db #0x04	; 4
    000000D5 02                     276 	.db #0x02	; 2
    000000D6 02                     277 	.db #0x02	; 2
    000000D7 01                     278 	.db #0x01	; 1
    000000D8 01                     279 	.db #0x01	; 1
    000000D9                        280 _reverse_bits:
    000000D9 00                     281 	.db #0x00	; 0
    000000DA 80                     282 	.db #0x80	; 128
    000000DB 40                     283 	.db #0x40	; 64
    000000DC C0                     284 	.db #0xc0	; 192
    000000DD 20                     285 	.db #0x20	; 32
    000000DE A0                     286 	.db #0xa0	; 160
    000000DF 60                     287 	.db #0x60	; 96
    000000E0 E0                     288 	.db #0xe0	; 224
    000000E1 10                     289 	.db #0x10	; 16
    000000E2 90                     290 	.db #0x90	; 144
    000000E3 50                     291 	.db #0x50	; 80	'P'
    000000E4 D0                     292 	.db #0xd0	; 208
    000000E5 30                     293 	.db #0x30	; 48	'0'
    000000E6 B0                     294 	.db #0xb0	; 176
    000000E7 70                     295 	.db #0x70	; 112	'p'
    000000E8 F0                     296 	.db #0xf0	; 240
    000000E9 08                     297 	.db #0x08	; 8
    000000EA 88                     298 	.db #0x88	; 136
    000000EB 48                     299 	.db #0x48	; 72	'H'
    000000EC C8                     300 	.db #0xc8	; 200
    000000ED 28                     301 	.db #0x28	; 40
    000000EE A8                     302 	.db #0xa8	; 168
    000000EF 68                     303 	.db #0x68	; 104	'h'
    000000F0 E8                     304 	.db #0xe8	; 232
    000000F1 18                     305 	.db #0x18	; 24
    000000F2 98                     306 	.db #0x98	; 152
    000000F3 58                     307 	.db #0x58	; 88	'X'
    000000F4 D8                     308 	.db #0xd8	; 216
    000000F5 38                     309 	.db #0x38	; 56	'8'
    000000F6 B8                     310 	.db #0xb8	; 184
    000000F7 78                     311 	.db #0x78	; 120	'x'
    000000F8 F8                     312 	.db #0xf8	; 248
    000000F9 04                     313 	.db #0x04	; 4
    000000FA 84                     314 	.db #0x84	; 132
    000000FB 44                     315 	.db #0x44	; 68	'D'
    000000FC C4                     316 	.db #0xc4	; 196
    000000FD 24                     317 	.db #0x24	; 36
    000000FE A4                     318 	.db #0xa4	; 164
    000000FF 64                     319 	.db #0x64	; 100	'd'
    00000100 E4                     320 	.db #0xe4	; 228
    00000101 14                     321 	.db #0x14	; 20
    00000102 94                     322 	.db #0x94	; 148
    00000103 54                     323 	.db #0x54	; 84	'T'
    00000104 D4                     324 	.db #0xd4	; 212
    00000105 34                     325 	.db #0x34	; 52	'4'
    00000106 B4                     326 	.db #0xb4	; 180
    00000107 74                     327 	.db #0x74	; 116	't'
    00000108 F4                     328 	.db #0xf4	; 244
    00000109 0C                     329 	.db #0x0c	; 12
    0000010A 8C                     330 	.db #0x8c	; 140
    0000010B 4C                     331 	.db #0x4c	; 76	'L'
    0000010C CC                     332 	.db #0xcc	; 204
    0000010D 2C                     333 	.db #0x2c	; 44
    0000010E AC                     334 	.db #0xac	; 172
    0000010F 6C                     335 	.db #0x6c	; 108	'l'
    00000110 EC                     336 	.db #0xec	; 236
    00000111 1C                     337 	.db #0x1c	; 28
    00000112 9C                     338 	.db #0x9c	; 156
    00000113 5C                     339 	.db #0x5c	; 92
    00000114 DC                     340 	.db #0xdc	; 220
    00000115 3C                     341 	.db #0x3c	; 60
    00000116 BC                     342 	.db #0xbc	; 188
    00000117 7C                     343 	.db #0x7c	; 124
    00000118 FC                     344 	.db #0xfc	; 252
    00000119 02                     345 	.db #0x02	; 2
    0000011A 82                     346 	.db #0x82	; 130
    0000011B 42                     347 	.db #0x42	; 66	'B'
    0000011C C2                     348 	.db #0xc2	; 194
    0000011D 22                     349 	.db #0x22	; 34
    0000011E A2                     350 	.db #0xa2	; 162
    0000011F 62                     351 	.db #0x62	; 98	'b'
    00000120 E2                     352 	.db #0xe2	; 226
    00000121 12                     353 	.db #0x12	; 18
    00000122 92                     354 	.db #0x92	; 146
    00000123 52                     355 	.db #0x52	; 82	'R'
    00000124 D2                     356 	.db #0xd2	; 210
    00000125 32                     357 	.db #0x32	; 50	'2'
    00000126 B2                     358 	.db #0xb2	; 178
    00000127 72                     359 	.db #0x72	; 114	'r'
    00000128 F2                     360 	.db #0xf2	; 242
    00000129 0A                     361 	.db #0x0a	; 10
    0000012A 8A                     362 	.db #0x8a	; 138
    0000012B 4A                     363 	.db #0x4a	; 74	'J'
    0000012C CA                     364 	.db #0xca	; 202
    0000012D 2A                     365 	.db #0x2a	; 42
    0000012E AA                     366 	.db #0xaa	; 170
    0000012F 6A                     367 	.db #0x6a	; 106	'j'
    00000130 EA                     368 	.db #0xea	; 234
    00000131 1A                     369 	.db #0x1a	; 26
    00000132 9A                     370 	.db #0x9a	; 154
    00000133 5A                     371 	.db #0x5a	; 90	'Z'
    00000134 DA                     372 	.db #0xda	; 218
    00000135 3A                     373 	.db #0x3a	; 58
    00000136 BA                     374 	.db #0xba	; 186
    00000137 7A                     375 	.db #0x7a	; 122	'z'
    00000138 FA                     376 	.db #0xfa	; 250
    00000139 06                     377 	.db #0x06	; 6
    0000013A 86                     378 	.db #0x86	; 134
    0000013B 46                     379 	.db #0x46	; 70	'F'
    0000013C C6                     380 	.db #0xc6	; 198
    0000013D 26                     381 	.db #0x26	; 38
    0000013E A6                     382 	.db #0xa6	; 166
    0000013F 66                     383 	.db #0x66	; 102	'f'
    00000140 E6                     384 	.db #0xe6	; 230
    00000141 16                     385 	.db #0x16	; 22
    00000142 96                     386 	.db #0x96	; 150
    00000143 56                     387 	.db #0x56	; 86	'V'
    00000144 D6                     388 	.db #0xd6	; 214
    00000145 36                     389 	.db #0x36	; 54	'6'
    00000146 B6                     390 	.db #0xb6	; 182
    00000147 76                     391 	.db #0x76	; 118	'v'
    00000148 F6                     392 	.db #0xf6	; 246
    00000149 0E                     393 	.db #0x0e	; 14
    0000014A 8E                     394 	.db #0x8e	; 142
    0000014B 4E                     395 	.db #0x4e	; 78	'N'
    0000014C CE                     396 	.db #0xce	; 206
    0000014D 2E                     397 	.db #0x2e	; 46
    0000014E AE                     398 	.db #0xae	; 174
    0000014F 6E                     399 	.db #0x6e	; 110	'n'
    00000150 EE                     400 	.db #0xee	; 238
    00000151 1E                     401 	.db #0x1e	; 30
    00000152 9E                     402 	.db #0x9e	; 158
    00000153 5E                     403 	.db #0x5e	; 94
    00000154 DE                     404 	.db #0xde	; 222
    00000155 3E                     405 	.db #0x3e	; 62
    00000156 BE                     406 	.db #0xbe	; 190
    00000157 7E                     407 	.db #0x7e	; 126
    00000158 FE                     408 	.db #0xfe	; 254
    00000159 01                     409 	.db #0x01	; 1
    0000015A 81                     410 	.db #0x81	; 129
    0000015B 41                     411 	.db #0x41	; 65	'A'
    0000015C C1                     412 	.db #0xc1	; 193
    0000015D 21                     413 	.db #0x21	; 33
    0000015E A1                     414 	.db #0xa1	; 161
    0000015F 61                     415 	.db #0x61	; 97	'a'
    00000160 E1                     416 	.db #0xe1	; 225
    00000161 11                     417 	.db #0x11	; 17
    00000162 91                     418 	.db #0x91	; 145
    00000163 51                     419 	.db #0x51	; 81	'Q'
    00000164 D1                     420 	.db #0xd1	; 209
    00000165 31                     421 	.db #0x31	; 49	'1'
    00000166 B1                     422 	.db #0xb1	; 177
    00000167 71                     423 	.db #0x71	; 113	'q'
    00000168 F1                     424 	.db #0xf1	; 241
    00000169 09                     425 	.db #0x09	; 9
    0000016A 89                     426 	.db #0x89	; 137
    0000016B 49                     427 	.db #0x49	; 73	'I'
    0000016C C9                     428 	.db #0xc9	; 201
    0000016D 29                     429 	.db #0x29	; 41
    0000016E A9                     430 	.db #0xa9	; 169
    0000016F 69                     431 	.db #0x69	; 105	'i'
    00000170 E9                     432 	.db #0xe9	; 233
    00000171 19                     433 	.db #0x19	; 25
    00000172 99                     434 	.db #0x99	; 153
    00000173 59                     435 	.db #0x59	; 89	'Y'
    00000174 D9                     436 	.db #0xd9	; 217
    00000175 39                     437 	.db #0x39	; 57	'9'
    00000176 B9                     438 	.db #0xb9	; 185
    00000177 79                     439 	.db #0x79	; 121	'y'
    00000178 F9                     440 	.db #0xf9	; 249
    00000179 05                     441 	.db #0x05	; 5
    0000017A 85                     442 	.db #0x85	; 133
    0000017B 45                     443 	.db #0x45	; 69	'E'
    0000017C C5                     444 	.db #0xc5	; 197
    0000017D 25                     445 	.db #0x25	; 37
    0000017E A5                     446 	.db #0xa5	; 165
    0000017F 65                     447 	.db #0x65	; 101	'e'
    00000180 E5                     448 	.db #0xe5	; 229
    00000181 15                     449 	.db #0x15	; 21
    00000182 95                     450 	.db #0x95	; 149
    00000183 55                     451 	.db #0x55	; 85	'U'
    00000184 D5                     452 	.db #0xd5	; 213
    00000185 35                     453 	.db #0x35	; 53	'5'
    00000186 B5                     454 	.db #0xb5	; 181
    00000187 75                     455 	.db #0x75	; 117	'u'
    00000188 F5                     456 	.db #0xf5	; 245
    00000189 0D                     457 	.db #0x0d	; 13
    0000018A 8D                     458 	.db #0x8d	; 141
    0000018B 4D                     459 	.db #0x4d	; 77	'M'
    0000018C CD                     460 	.db #0xcd	; 205
    0000018D 2D                     461 	.db #0x2d	; 45
    0000018E AD                     462 	.db #0xad	; 173
    0000018F 6D                     463 	.db #0x6d	; 109	'm'
    00000190 ED                     464 	.db #0xed	; 237
    00000191 1D                     465 	.db #0x1d	; 29
    00000192 9D                     466 	.db #0x9d	; 157
    00000193 5D                     467 	.db #0x5d	; 93
    00000194 DD                     468 	.db #0xdd	; 221
    00000195 3D                     469 	.db #0x3d	; 61
    00000196 BD                     470 	.db #0xbd	; 189
    00000197 7D                     471 	.db #0x7d	; 125
    00000198 FD                     472 	.db #0xfd	; 253
    00000199 03                     473 	.db #0x03	; 3
    0000019A 83                     474 	.db #0x83	; 131
    0000019B 43                     475 	.db #0x43	; 67	'C'
    0000019C C3                     476 	.db #0xc3	; 195
    0000019D 23                     477 	.db #0x23	; 35
    0000019E A3                     478 	.db #0xa3	; 163
    0000019F 63                     479 	.db #0x63	; 99	'c'
    000001A0 E3                     480 	.db #0xe3	; 227
    000001A1 13                     481 	.db #0x13	; 19
    000001A2 93                     482 	.db #0x93	; 147
    000001A3 53                     483 	.db #0x53	; 83	'S'
    000001A4 D3                     484 	.db #0xd3	; 211
    000001A5 33                     485 	.db #0x33	; 51	'3'
    000001A6 B3                     486 	.db #0xb3	; 179
    000001A7 73                     487 	.db #0x73	; 115	's'
    000001A8 F3                     488 	.db #0xf3	; 243
    000001A9 0B                     489 	.db #0x0b	; 11
    000001AA 8B                     490 	.db #0x8b	; 139
    000001AB 4B                     491 	.db #0x4b	; 75	'K'
    000001AC CB                     492 	.db #0xcb	; 203
    000001AD 2B                     493 	.db #0x2b	; 43
    000001AE AB                     494 	.db #0xab	; 171
    000001AF 6B                     495 	.db #0x6b	; 107	'k'
    000001B0 EB                     496 	.db #0xeb	; 235
    000001B1 1B                     497 	.db #0x1b	; 27
    000001B2 9B                     498 	.db #0x9b	; 155
    000001B3 5B                     499 	.db #0x5b	; 91
    000001B4 DB                     500 	.db #0xdb	; 219
    000001B5 3B                     501 	.db #0x3b	; 59
    000001B6 BB                     502 	.db #0xbb	; 187
    000001B7 7B                     503 	.db #0x7b	; 123
    000001B8 FB                     504 	.db #0xfb	; 251
    000001B9 07                     505 	.db #0x07	; 7
    000001BA 87                     506 	.db #0x87	; 135
    000001BB 47                     507 	.db #0x47	; 71	'G'
    000001BC C7                     508 	.db #0xc7	; 199
    000001BD 27                     509 	.db #0x27	; 39
    000001BE A7                     510 	.db #0xa7	; 167
    000001BF 67                     511 	.db #0x67	; 103	'g'
    000001C0 E7                     512 	.db #0xe7	; 231
    000001C1 17                     513 	.db #0x17	; 23
    000001C2 97                     514 	.db #0x97	; 151
    000001C3 57                     515 	.db #0x57	; 87	'W'
    000001C4 D7                     516 	.db #0xd7	; 215
    000001C5 37                     517 	.db #0x37	; 55	'7'
    000001C6 B7                     518 	.db #0xb7	; 183
    000001C7 77                     519 	.db #0x77	; 119	'w'
    000001C8 F7                     520 	.db #0xf7	; 247
    000001C9 0F                     521 	.db #0x0f	; 15
    000001CA 8F                     522 	.db #0x8f	; 143
    000001CB 4F                     523 	.db #0x4f	; 79	'O'
    000001CC CF                     524 	.db #0xcf	; 207
    000001CD 2F                     525 	.db #0x2f	; 47
    000001CE AF                     526 	.db #0xaf	; 175
    000001CF 6F                     527 	.db #0x6f	; 111	'o'
    000001D0 EF                     528 	.db #0xef	; 239
    000001D1 1F                     529 	.db #0x1f	; 31
    000001D2 9F                     530 	.db #0x9f	; 159
    000001D3 5F                     531 	.db #0x5f	; 95
    000001D4 DF                     532 	.db #0xdf	; 223
    000001D5 3F                     533 	.db #0x3f	; 63
    000001D6 BF                     534 	.db #0xbf	; 191
    000001D7 7F                     535 	.db #0x7f	; 127
    000001D8 FF                     536 	.db #0xff	; 255
                                    537 ;src/metasprites.c:106: uint8_t get_tile_offset(uint8_t flipx, uint8_t flipy)
                                    538 ;	---------------------------------
                                    539 ; Function get_tile_offset
                                    540 ; ---------------------------------
    000001D9                        541 _get_tile_offset::
    000001D9 4F               [ 4]  542 	ld	c, a
                                    543 ;src/metasprites.c:111: offset += flipy ? num_tiles : 0;
    000001DA 7D               [ 4]  544 	ld	a, l
    000001DB 2Ar1Br00         [16]  545 	ld	hl, (_num_tiles)
    000001DE B7               [ 4]  546 	or	a, a
    000001DF 28 03            [12]  547 	jr	Z, 00103$
    000001E1 7D               [ 4]  548 	ld	a, l
    000001E2 18 01            [12]  549 	jr	00104$
    000001E4                        550 00103$:
    000001E4 AF               [ 4]  551 	xor	a, a
    000001E5                        552 00104$:
                                    553 ;src/metasprites.c:114: offset <<= 1;
    000001E5 87               [ 4]  554 	add	a, a
                                    555 ;src/metasprites.c:115: offset += flipx ? num_tiles : 0;
    000001E6 0C               [ 4]  556 	inc	c
    000001E7 0D               [ 4]  557 	dec	c
    000001E8 28 03            [12]  558 	jr	Z, 00105$
    000001EA 4D               [ 4]  559 	ld	c, l
    000001EB 18 03            [12]  560 	jr	00106$
    000001ED                        561 00105$:
    000001ED 01 00 00         [10]  562 	ld	bc, #0x0000
    000001F0                        563 00106$:
    000001F0 81               [ 4]  564 	add	a, c
                                    565 ;src/metasprites.c:117: return offset;
                                    566 ;src/metasprites.c:118: }
    000001F1 C9               [10]  567 	ret
                                    568 ;src/metasprites.c:123: void load_and_duplicate_sprite_tile_data(void)
                                    569 ;	---------------------------------
                                    570 ; Function load_and_duplicate_sprite_tile_data
                                    571 ; ---------------------------------
    000001F2                        572 _load_and_duplicate_sprite_tile_data::
    000001F2 DD E5            [15]  573 	push	ix
    000001F4 DD 21 00 00      [14]  574 	ld	ix,#0
    000001F8 DD 39            [15]  575 	add	ix,sp
    000001FA F5               [11]  576 	push	af
    000001FB 3B               [ 6]  577 	dec	sp
                                    578 ;src/metasprites.c:126: num_tiles = sizeof(sprite_tiles) >> 4;
    000001FC 21 30 00         [10]  579 	ld	hl, #0x0030
    000001FF 22r1Br00         [16]  580 	ld	(_num_tiles), hl
                                    581 ;src/metasprites.c:127: for(i = 0; i < num_tiles; i++)
    00000202 AF               [ 4]  582 	xor	a, a
    00000203 DD 77 FE         [19]  583 	ld	-2 (ix), a
    00000206 DD 77 FF         [19]  584 	ld	-1 (ix), a
    00000209                        585 00103$:
    00000209 21r1Br00         [10]  586 	ld	hl, #_num_tiles
    0000020C DD 7E FE         [19]  587 	ld	a, -2 (ix)
    0000020F 96               [ 7]  588 	sub	a, (hl)
    00000210 DD 7E FF         [19]  589 	ld	a, -1 (ix)
    00000213 23               [ 6]  590 	inc	hl
    00000214 9E               [ 7]  591 	sbc	a, (hl)
    00000215 D2r98r02         [10]  592 	jp	NC, 00105$
                                    593 ;src/metasprites.c:129: set_tile(i + get_tile_offset(0, 0), sprite_tiles + (i << 4), 0, 0);
    00000218 DD 6E FE         [19]  594 	ld	l, -2 (ix)
    0000021B DD 66 FF         [19]  595 	ld	h, -1 (ix)
    0000021E 29               [11]  596 	add	hl, hl
    0000021F 29               [11]  597 	add	hl, hl
    00000220 29               [11]  598 	add	hl, hl
    00000221 29               [11]  599 	add	hl, hl
    00000222 11r00r00         [10]  600 	ld	de, #_sprite_tiles
    00000225 19               [11]  601 	add	hl, de
    00000226 5D               [ 4]  602 	ld	e, l
    00000227 54               [ 4]  603 	ld	d, h
    00000228 DD 7E FE         [19]  604 	ld	a, -2 (ix)
    0000022B DD 77 FD         [19]  605 	ld	-3 (ix), a
    0000022E E5               [11]  606 	push	hl
    0000022F D5               [11]  607 	push	de
                                    608 ;	spillPairReg hl
                                    609 ;	spillPairReg hl
    00000230 AF               [ 4]  610 	xor	a, a
    00000231 6F               [ 4]  611 	ld	l, a
    00000232 CDrD9r01         [17]  612 	call	_get_tile_offset
    00000235 D1               [10]  613 	pop	de
    00000236 E1               [10]  614 	pop	hl
    00000237 DD 86 FD         [19]  615 	add	a, -3 (ix)
    0000023A 4F               [ 4]  616 	ld	c, a
    0000023B E5               [11]  617 	push	hl
    0000023C 21 00 00         [10]  618 	ld	hl, #0x00
    0000023F E5               [11]  619 	push	hl
    00000240 79               [ 4]  620 	ld	a, c
    00000241 CDr00r00         [17]  621 	call	_set_tile
    00000244 E1               [10]  622 	pop	hl
                                    623 ;src/metasprites.c:131: set_tile(i + get_tile_offset(1, 0), sprite_tiles + (i << 4), 1, 0);
    00000245 5D               [ 4]  624 	ld	e, l
    00000246 54               [ 4]  625 	ld	d, h
    00000247 E5               [11]  626 	push	hl
    00000248 D5               [11]  627 	push	de
    00000249 2E 00            [ 7]  628 	ld	l, #0x00
                                    629 ;	spillPairReg hl
                                    630 ;	spillPairReg hl
    0000024B 3E 01            [ 7]  631 	ld	a, #0x01
    0000024D CDrD9r01         [17]  632 	call	_get_tile_offset
    00000250 D1               [10]  633 	pop	de
    00000251 E1               [10]  634 	pop	hl
    00000252 DD 86 FD         [19]  635 	add	a, -3 (ix)
    00000255 4F               [ 4]  636 	ld	c, a
    00000256 E5               [11]  637 	push	hl
    00000257 21 01 00         [10]  638 	ld	hl, #0x01
    0000025A E5               [11]  639 	push	hl
    0000025B 79               [ 4]  640 	ld	a, c
    0000025C CDr00r00         [17]  641 	call	_set_tile
    0000025F E1               [10]  642 	pop	hl
                                    643 ;src/metasprites.c:134: set_tile(i + get_tile_offset(0, 1), sprite_tiles + (i << 4), 0, 1);
    00000260 5D               [ 4]  644 	ld	e, l
    00000261 54               [ 4]  645 	ld	d, h
    00000262 E5               [11]  646 	push	hl
    00000263 D5               [11]  647 	push	de
    00000264 2E 01            [ 7]  648 	ld	l, #0x01
                                    649 ;	spillPairReg hl
                                    650 ;	spillPairReg hl
    00000266 AF               [ 4]  651 	xor	a, a
    00000267 CDrD9r01         [17]  652 	call	_get_tile_offset
    0000026A D1               [10]  653 	pop	de
    0000026B E1               [10]  654 	pop	hl
    0000026C DD 86 FD         [19]  655 	add	a, -3 (ix)
    0000026F 4F               [ 4]  656 	ld	c, a
    00000270 E5               [11]  657 	push	hl
    00000271 21 00 01         [10]  658 	ld	hl, #0x100
    00000274 E5               [11]  659 	push	hl
    00000275 79               [ 4]  660 	ld	a, c
    00000276 CDr00r00         [17]  661 	call	_set_tile
                                    662 ;	spillPairReg hl
                                    663 ;	spillPairReg hl
    00000279 3E 01            [ 7]  664 	ld	a,#0x01
    0000027B 6F               [ 4]  665 	ld	l,a
    0000027C CDrD9r01         [17]  666 	call	_get_tile_offset
    0000027F D1               [10]  667 	pop	de
    00000280 DD 86 FD         [19]  668 	add	a, -3 (ix)
    00000283 4F               [ 4]  669 	ld	c, a
    00000284 21 01 01         [10]  670 	ld	hl, #0x101
    00000287 E5               [11]  671 	push	hl
    00000288 79               [ 4]  672 	ld	a, c
    00000289 CDr00r00         [17]  673 	call	_set_tile
                                    674 ;src/metasprites.c:127: for(i = 0; i < num_tiles; i++)
    0000028C DD 34 FE         [23]  675 	inc	-2 (ix)
    0000028F C2r09r02         [10]  676 	jp	NZ,00103$
    00000292 DD 34 FF         [23]  677 	inc	-1 (ix)
    00000295 C3r09r02         [10]  678 	jp	00103$
    00000298                        679 00105$:
                                    680 ;src/metasprites.c:140: }
    00000298 DD F9            [10]  681 	ld	sp, ix
    0000029A DD E1            [14]  682 	pop	ix
    0000029C C9               [10]  683 	ret
                                    684 ;src/metasprites.c:160: void main(void) {
                                    685 ;	---------------------------------
                                    686 ; Function main
                                    687 ; ---------------------------------
    0000029D                        688 _main::
    0000029D DD E5            [15]  689 	push	ix
    0000029F DD 21 00 00      [14]  690 	ld	ix,#0
    000002A3 DD 39            [15]  691 	add	ix,sp
    000002A5 21 F7 FF         [10]  692 	ld	hl, #-9
    000002A8 39               [11]  693 	add	hl, sp
    000002A9 F9               [ 6]  694 	ld	sp, hl
                                    695 ;../../../include/sms/sms.h:254: __WRITE_VDP_REG(VDP_R1, __READ_VDP_REG(VDP_R1) &= (~R1_DISP_ON));
    000002AA 3Ar00r00         [13]  696 	ld	a, (_shadow_VDP_R1+0)
    000002AD E6 BF            [ 7]  697 	and	a, #0xbf
    000002AF 32r00r00         [13]  698 	ld	(_shadow_VDP_R1+0), a
    000002B2 F3               [ 4]  699 	di
    000002B3 3Ar00r00         [13]  700 	ld	a, (_shadow_VDP_R1+0)
    000002B6 D3 BF            [11]  701 	out	(_VDP_CMD), a
    000002B8 3E 81            [ 7]  702 	ld	a, #0x81
    000002BA D3 BF            [11]  703 	out	(_VDP_CMD), a
    000002BC FB               [ 4]  704 	ei
                                    705 ;src/metasprites.c:177: fill_bkg_rect(0, 0, DEVICE_SCREEN_WIDTH, DEVICE_SCREEN_HEIGHT, 0);
    000002BD 21 00 00         [10]  706 	ld	hl, #0x0000
    000002C0 E5               [11]  707 	push	hl
    000002C1 21 14 12         [10]  708 	ld	hl, #0x1214
    000002C4 E5               [11]  709 	push	hl
    000002C5 21 00 00         [10]  710 	ld	hl, #0x00
    000002C8 E5               [11]  711 	push	hl
    000002C9 CDr00r00         [17]  712 	call	_fill_rect_compat
                                    713 ;src/metasprites.c:180: set_bkg_data(0, 1, pattern);
                                    714 ;../../../include/sms/sms.h:633: set_tile_2bpp_data(start, ntiles, src, _current_2bpp_palette);
    000002CC 2Ar00r00         [16]  715 	ld	hl, (__current_2bpp_palette)
    000002CF E5               [11]  716 	push	hl
    000002D0 21rC9r00         [10]  717 	ld	hl, #_pattern
    000002D3 E5               [11]  718 	push	hl
    000002D4 21 01 00         [10]  719 	ld	hl, #0x0001
    000002D7 E5               [11]  720 	push	hl
    000002D8 6C               [ 4]  721 	ld	l, h
    000002D9 E5               [11]  722 	push	hl
    000002DA CDr00r00         [17]  723 	call	_set_tile_2bpp_data
                                    724 ;src/metasprites.c:183: load_and_duplicate_sprite_tile_data();
    000002DD CDrF2r01         [17]  725 	call	_load_and_duplicate_sprite_tile_data
                                    726 ;src/metasprites.c:186: SHOW_BKG; SHOW_SPRITES;
    000002E0 FD 21r00r00      [14]  727 	ld	iy, #__sprites_OFF
    000002E4 FD 36 00 00      [19]  728 	ld	0 (iy), #0x00
                                    729 ;src/metasprites.c:192: SPRITES_8x8;
    000002E8 3Ar00r00         [13]  730 	ld	a, (_shadow_VDP_R1+0)
    000002EB E6 FD            [ 7]  731 	and	a, #0xfd
    000002ED 32r00r00         [13]  732 	ld	(_shadow_VDP_R1+0), a
    000002F0 F3               [ 4]  733 	di
    000002F1 3Ar00r00         [13]  734 	ld	a, (_shadow_VDP_R1+0)
    000002F4 D3 BF            [11]  735 	out	(_VDP_CMD), a
    000002F6 3E 81            [ 7]  736 	ld	a, #0x81
    000002F8 D3 BF            [11]  737 	out	(_VDP_CMD), a
    000002FA FB               [ 4]  738 	ei
                                    739 ;src/metasprites.c:194: DISPLAY_ON;
    000002FB 3Ar00r00         [13]  740 	ld	a, (_shadow_VDP_R1+0)
    000002FE F6 40            [ 7]  741 	or	a, #0x40
    00000300 32r00r00         [13]  742 	ld	(_shadow_VDP_R1+0), a
    00000303 F3               [ 4]  743 	di
    00000304 3Ar00r00         [13]  744 	ld	a, (_shadow_VDP_R1+0)
    00000307 D3 BF            [11]  745 	out	(_VDP_CMD), a
    00000309 3E 81            [ 7]  746 	ld	a, #0x81
    0000030B D3 BF            [11]  747 	out	(_VDP_CMD), a
    0000030D FB               [ 4]  748 	ei
                                    749 ;src/metasprites.c:197: PosX = (DEVICE_SCREEN_PX_WIDTH / 2) << 4;
    0000030E 21 00 05         [10]  750 	ld	hl, #0x0500
    00000311 22r00r00         [16]  751 	ld	(_PosX), hl
                                    752 ;src/metasprites.c:198: PosY = (DEVICE_SCREEN_PX_HEIGHT / 2) << 4;
    00000314 21 80 04         [10]  753 	ld	hl, #0x0480
    00000317 22r02r00         [16]  754 	ld	(_PosY), hl
                                    755 ;src/metasprites.c:199: SpdX = SpdY = 0;
    0000031A 21 00 00         [10]  756 	ld	hl, #0x0000
    0000031D 22r06r00         [16]  757 	ld	(_SpdY), hl
    00000320 22r04r00         [16]  758 	ld	(_SpdX), hl
                                    759 ;src/metasprites.c:201: idx = 0; rot = 0;
    00000323 AF               [ 4]  760 	xor	a, a
    00000324 32r09r00         [13]  761 	ld	(#_idx), a
    00000327 AF               [ 4]  762 	xor	a, a
    00000328 32r0Ar00         [13]  763 	ld	(#_rot), a
                                    764 ;src/metasprites.c:203: while(TRUE) {        
    0000032B                        765 00145$:
                                    766 ;src/metasprites.c:205: KEY_INPUT;
    0000032B 3Ar00r00         [13]  767 	ld	a, (_joyp+0)
    0000032E 32r01r00         [13]  768 	ld	(_old_joyp+0), a
    00000331 CDr00r00         [17]  769 	call	_joypad
    00000334 7D               [ 4]  770 	ld	a, l
    00000335 32r00r00         [13]  771 	ld	(_joyp+0), a
                                    772 ;src/metasprites.c:207: PosF = 0;
    00000338 21r08r00         [10]  773 	ld	hl, #_PosF
    0000033B 36 00            [10]  774 	ld	(hl), #0x00
                                    775 ;src/metasprites.c:209: if (KEY_DOWN(J_UP)) {
    0000033D 3Ar00r00         [13]  776 	ld	a, (_joyp+0)
    00000340 DD 77 FE         [19]  777 	ld	-2 (ix), a
                                    778 ;src/metasprites.c:210: SpdY -= 2;
    00000343 2Ar06r00         [16]  779 	ld	hl, (_SpdY)
                                    780 ;src/metasprites.c:212: PosF |= ACC_Y;
    00000346 3Ar08r00         [13]  781 	ld	a, (_PosF+0)
    00000349 F6 02            [ 7]  782 	or	a, #0x02
    0000034B DD 77 FF         [19]  783 	ld	-1 (ix), a
                                    784 ;src/metasprites.c:209: if (KEY_DOWN(J_UP)) {
    0000034E DD CB FE 46      [20]  785 	bit	0, -2 (ix)
    00000352 28 22            [12]  786 	jr	Z, 00108$
                                    787 ;src/metasprites.c:210: SpdY -= 2;
    00000354 2B               [ 6]  788 	dec	hl
    00000355 2B               [ 6]  789 	dec	hl
    00000356 22r06r00         [16]  790 	ld	(_SpdY), hl
                                    791 ;src/metasprites.c:211: if (SpdY < -32) SpdY = -32;
    00000359 3Ar06r00         [13]  792 	ld	a, (_SpdY+0)
    0000035C D6 E0            [ 7]  793 	sub	a, #0xe0
    0000035E 3Ar07r00         [13]  794 	ld	a, (_SpdY+1)
    00000361 17               [ 4]  795 	rla
    00000362 3F               [ 4]  796 	ccf
    00000363 1F               [ 4]  797 	rra
    00000364 DE 7F            [ 7]  798 	sbc	a, #0x7f
    00000366 30 06            [12]  799 	jr	NC, 00102$
    00000368 21 E0 FF         [10]  800 	ld	hl, #0xffe0
    0000036B 22r06r00         [16]  801 	ld	(_SpdY), hl
    0000036E                        802 00102$:
                                    803 ;src/metasprites.c:212: PosF |= ACC_Y;
    0000036E DD 7E FF         [19]  804 	ld	a, -1 (ix)
    00000371 32r08r00         [13]  805 	ld	(_PosF+0), a
    00000374 18 2B            [12]  806 	jr	00109$
    00000376                        807 00108$:
                                    808 ;src/metasprites.c:213: } else if (KEY_DOWN(J_DOWN)) {
    00000376 DD CB FE 4E      [20]  809 	bit	1, -2 (ix)
    0000037A 28 25            [12]  810 	jr	Z, 00109$
                                    811 ;src/metasprites.c:214: SpdY += 2;
    0000037C 23               [ 6]  812 	inc	hl
    0000037D 23               [ 6]  813 	inc	hl
    0000037E 4D               [ 4]  814 	ld	c, l
    0000037F 44               [ 4]  815 	ld	b, h
    00000380 ED 43r06r00      [20]  816 	ld	(_SpdY), bc
                                    817 ;src/metasprites.c:215: if (SpdY > 32) SpdY = 32;
    00000384 2Ar06r00         [16]  818 	ld	hl, (_SpdY)
    00000387 3E 20            [ 7]  819 	ld	a, #0x20
    00000389 BD               [ 4]  820 	cp	a, l
    0000038A 3E 00            [ 7]  821 	ld	a, #0x00
    0000038C 9C               [ 4]  822 	sbc	a, h
    0000038D E2r92r03         [10]  823 	jp	PO, 00322$
    00000390 EE 80            [ 7]  824 	xor	a, #0x80
    00000392                        825 00322$:
    00000392 F2r9Br03         [10]  826 	jp	P, 00104$
    00000395 21 20 00         [10]  827 	ld	hl, #0x0020
    00000398 22r06r00         [16]  828 	ld	(_SpdY), hl
    0000039B                        829 00104$:
                                    830 ;src/metasprites.c:216: PosF |= ACC_Y;
    0000039B DD 7E FF         [19]  831 	ld	a, -1 (ix)
    0000039E 32r08r00         [13]  832 	ld	(_PosF+0), a
    000003A1                        833 00109$:
                                    834 ;src/metasprites.c:220: SpdX -= 2;
    000003A1 ED 5Br04r00      [20]  835 	ld	de, (_SpdX)
                                    836 ;src/metasprites.c:222: PosF |= ACC_X;
    000003A5 3Ar08r00         [13]  837 	ld	a, (_PosF+0)
    000003A8 F6 01            [ 7]  838 	or	a, #0x01
    000003AA DD 77 FF         [19]  839 	ld	-1 (ix), a
                                    840 ;src/metasprites.c:219: if (KEY_DOWN(J_LEFT)) {
    000003AD DD CB FE 56      [20]  841 	bit	2, -2 (ix)
    000003B1 28 23            [12]  842 	jr	Z, 00117$
                                    843 ;src/metasprites.c:220: SpdX -= 2;
    000003B3 1B               [ 6]  844 	dec	de
    000003B4 1B               [ 6]  845 	dec	de
    000003B5 ED 53r04r00      [20]  846 	ld	(_SpdX), de
                                    847 ;src/metasprites.c:221: if (SpdX < -32) SpdX = -32;
    000003B9 3Ar04r00         [13]  848 	ld	a, (_SpdX+0)
    000003BC D6 E0            [ 7]  849 	sub	a, #0xe0
    000003BE 3Ar05r00         [13]  850 	ld	a, (_SpdX+1)
    000003C1 17               [ 4]  851 	rla
    000003C2 3F               [ 4]  852 	ccf
    000003C3 1F               [ 4]  853 	rra
    000003C4 DE 7F            [ 7]  854 	sbc	a, #0x7f
    000003C6 30 06            [12]  855 	jr	NC, 00111$
    000003C8 21 E0 FF         [10]  856 	ld	hl, #0xffe0
    000003CB 22r04r00         [16]  857 	ld	(_SpdX), hl
    000003CE                        858 00111$:
                                    859 ;src/metasprites.c:222: PosF |= ACC_X;
    000003CE DD 7E FF         [19]  860 	ld	a, -1 (ix)
    000003D1 32r08r00         [13]  861 	ld	(_PosF+0), a
    000003D4 18 29            [12]  862 	jr	00118$
    000003D6                        863 00117$:
                                    864 ;src/metasprites.c:223: } else if (KEY_DOWN(J_RIGHT)) {
    000003D6 DD CB FE 5E      [20]  865 	bit	3, -2 (ix)
    000003DA 28 23            [12]  866 	jr	Z, 00118$
                                    867 ;src/metasprites.c:224: SpdX += 2;
    000003DC 13               [ 6]  868 	inc	de
    000003DD 13               [ 6]  869 	inc	de
    000003DE ED 53r04r00      [20]  870 	ld	(_SpdX), de
                                    871 ;src/metasprites.c:225: if (SpdX > 32) SpdX = 32;
    000003E2 2Ar04r00         [16]  872 	ld	hl, (_SpdX)
    000003E5 3E 20            [ 7]  873 	ld	a, #0x20
    000003E7 BD               [ 4]  874 	cp	a, l
    000003E8 3E 00            [ 7]  875 	ld	a, #0x00
    000003EA 9C               [ 4]  876 	sbc	a, h
    000003EB E2rF0r03         [10]  877 	jp	PO, 00325$
    000003EE EE 80            [ 7]  878 	xor	a, #0x80
    000003F0                        879 00325$:
    000003F0 F2rF9r03         [10]  880 	jp	P, 00113$
    000003F3 21 20 00         [10]  881 	ld	hl, #0x0020
    000003F6 22r04r00         [16]  882 	ld	(_SpdX), hl
    000003F9                        883 00113$:
                                    884 ;src/metasprites.c:226: PosF |= ACC_X;
    000003F9 DD 7E FF         [19]  885 	ld	a, -1 (ix)
    000003FC 32r08r00         [13]  886 	ld	(_PosF+0), a
    000003FF                        887 00118$:
                                    888 ;src/metasprites.c:230: if (KEY_PRESSED(J_B)) {
    000003FF 3Ar00r00         [13]  889 	ld	a, (_joyp+0)
    00000402 21r01r00         [10]  890 	ld	hl, #_old_joyp
    00000405 AE               [ 7]  891 	xor	a, (hl)
    00000406 21r00r00         [10]  892 	ld	hl, #_joyp
    00000409 A6               [ 7]  893 	and	a, (hl)
    0000040A 4F               [ 4]  894 	ld	c, a
    0000040B CB 61            [ 8]  895 	bit	4, c
    0000040D 28 12            [12]  896 	jr	Z, 00122$
                                    897 ;src/metasprites.c:231: idx++; if (idx >= (sizeof(sprite_metasprites) >> 1)) idx = 0;
    0000040F FD 21r09r00      [14]  898 	ld	iy, #_idx
    00000413 FD 34 00         [23]  899 	inc	0 (iy)
    00000416 3Ar09r00         [13]  900 	ld	a, (_idx+0)
    00000419 D6 05            [ 7]  901 	sub	a, #0x05
    0000041B 38 04            [12]  902 	jr	C, 00122$
    0000041D FD 36 00 00      [19]  903 	ld	0 (iy), #0x00
    00000421                        904 00122$:
                                    905 ;src/metasprites.c:235: if (KEY_PRESSED(J_A)) {
    00000421 CB 69            [ 8]  906 	bit	5, c
    00000423 28 0C            [12]  907 	jr	Z, 00124$
                                    908 ;src/metasprites.c:236: rot++; rot &= 0xF;
    00000425 21r0Ar00         [10]  909 	ld	hl, #_rot
    00000428 34               [11]  910 	inc	(hl)
    00000429 3Ar0Ar00         [13]  911 	ld	a, (_rot+0)
    0000042C E6 0F            [ 7]  912 	and	a, #0x0f
    0000042E 32r0Ar00         [13]  913 	ld	(_rot+0), a
    00000431                        914 00124$:
                                    915 ;src/metasprites.c:239: PosX += SpdX, PosY += SpdY; 
    00000431 21r04r00         [10]  916 	ld	hl, #_SpdX
    00000434 D5               [11]  917 	push	de
    00000435 11r00r00         [10]  918 	ld	de, #_PosX
    00000438 1A               [ 7]  919 	ld	a, (de)
    00000439 86               [ 7]  920 	add	a, (hl)
    0000043A 23               [ 6]  921 	inc	hl
    0000043B 12               [ 7]  922 	ld	(de), a
    0000043C 13               [ 6]  923 	inc	de
    0000043D 1A               [ 7]  924 	ld	a, (de)
    0000043E 8E               [ 7]  925 	adc	a, (hl)
    0000043F 12               [ 7]  926 	ld	(de), a
    00000440 D1               [10]  927 	pop	de
    00000441 21r06r00         [10]  928 	ld	hl, #_SpdY
    00000444 D5               [11]  929 	push	de
    00000445 11r02r00         [10]  930 	ld	de, #_PosY
    00000448 1A               [ 7]  931 	ld	a, (de)
    00000449 86               [ 7]  932 	add	a, (hl)
    0000044A 23               [ 6]  933 	inc	hl
    0000044B 12               [ 7]  934 	ld	(de), a
    0000044C 13               [ 6]  935 	inc	de
    0000044D 1A               [ 7]  936 	ld	a, (de)
    0000044E 8E               [ 7]  937 	adc	a, (hl)
    0000044F 12               [ 7]  938 	ld	(de), a
    00000450 D1               [10]  939 	pop	de
                                    940 ;src/metasprites.c:251: switch (rot & 0x3) {
    00000451 3Ar0Ar00         [13]  941 	ld	a, (_rot+0)
    00000454 E6 03            [ 7]  942 	and	a, #0x03
    00000456 DD 77 FB         [19]  943 	ld	-5 (ix), a
                                    944 ;src/metasprites.c:258: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    00000459 3Ar02r00         [13]  945 	ld	a, (_PosY+0)
    0000045C DD 77 FE         [19]  946 	ld	-2 (ix), a
    0000045F 3Ar03r00         [13]  947 	ld	a, (_PosY+1)
    00000462 DD 77 FF         [19]  948 	ld	-1 (ix), a
    00000465 DD CB FF 2E      [23]  949 	sra	-1 (ix)
    00000469 DD CB FE 1E      [23]  950 	rr	-2 (ix)
    0000046D DD CB FF 2E      [23]  951 	sra	-1 (ix)
    00000471 DD CB FE 1E      [23]  952 	rr	-2 (ix)
    00000475 DD CB FF 2E      [23]  953 	sra	-1 (ix)
    00000479 DD CB FE 1E      [23]  954 	rr	-2 (ix)
    0000047D DD CB FF 2E      [23]  955 	sra	-1 (ix)
    00000481 DD CB FE 1E      [23]  956 	rr	-2 (ix)
                                    957 ;src/metasprites.c:257: DEVICE_SPRITE_PX_OFFSET_X + (PosX >> 4),
    00000485 3Ar00r00         [13]  958 	ld	a, (_PosX+0)
    00000488 DD 77 FC         [19]  959 	ld	-4 (ix), a
    0000048B 3Ar01r00         [13]  960 	ld	a, (_PosX+1)
    0000048E DD 77 FD         [19]  961 	ld	-3 (ix), a
    00000491 DD CB FD 2E      [23]  962 	sra	-3 (ix)
    00000495 DD CB FC 1E      [23]  963 	rr	-4 (ix)
    00000499 DD CB FD 2E      [23]  964 	sra	-3 (ix)
    0000049D DD CB FC 1E      [23]  965 	rr	-4 (ix)
    000004A1 DD CB FD 2E      [23]  966 	sra	-3 (ix)
    000004A5 DD CB FC 1E      [23]  967 	rr	-4 (ix)
    000004A9 DD CB FD 2E      [23]  968 	sra	-3 (ix)
    000004AD DD CB FC 1E      [23]  969 	rr	-4 (ix)
                                    970 ;src/metasprites.c:258: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
                                    971 ;src/metasprites.c:257: DEVICE_SPRITE_PX_OFFSET_X + (PosX >> 4),
    000004B1 DD 7E FC         [19]  972 	ld	a, -4 (ix)
    000004B4 DD 77 F9         [19]  973 	ld	-7 (ix), a
    000004B7 DD 7E FD         [19]  974 	ld	a, -3 (ix)
    000004BA DD 77 FA         [19]  975 	ld	-6 (ix), a
                                    976 ;src/metasprites.c:258: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    000004BD DD 7E FE         [19]  977 	ld	a, -2 (ix)
    000004C0 C6 17            [ 7]  978 	add	a, #0x17
    000004C2 DD 77 FC         [19]  979 	ld	-4 (ix), a
    000004C5 DD 7E FF         [19]  980 	ld	a, -1 (ix)
    000004C8 CE 00            [ 7]  981 	adc	a, #0x00
    000004CA DD 77 FD         [19]  982 	ld	-3 (ix), a
                                    983 ;src/metasprites.c:257: DEVICE_SPRITE_PX_OFFSET_X + (PosX >> 4),
    000004CD DD 7E F9         [19]  984 	ld	a, -7 (ix)
    000004D0 C6 30            [ 7]  985 	add	a, #0x30
    000004D2 DD 77 FE         [19]  986 	ld	-2 (ix), a
    000004D5 DD 7E FA         [19]  987 	ld	a, -6 (ix)
    000004D8 CE 00            [ 7]  988 	adc	a, #0x00
    000004DA DD 77 FF         [19]  989 	ld	-1 (ix), a
                                    990 ;src/metasprites.c:258: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
                                    991 ;src/metasprites.c:257: DEVICE_SPRITE_PX_OFFSET_X + (PosX >> 4),
                                    992 ;src/metasprites.c:251: switch (rot & 0x3) {
    000004DD DD 7E FB         [19]  993 	ld	a, -5 (ix)
    000004E0 3D               [ 4]  994 	dec	a
    000004E1 28 12            [12]  995 	jr	Z, 00125$
    000004E3 DD 7E FB         [19]  996 	ld	a, -5 (ix)
    000004E6 D6 02            [ 7]  997 	sub	a, #0x02
    000004E8 28 5E            [12]  998 	jr	Z, 00126$
    000004EA DD 7E FB         [19]  999 	ld	a, -5 (ix)
    000004ED D6 03            [ 7] 1000 	sub	a, #0x03
    000004EF CArA3r05         [10] 1001 	jp	Z,00127$
    000004F2 C3r4Br06         [10] 1002 	jp	00128$
                                   1003 ;src/metasprites.c:252: case 1:
    000004F5                       1004 00125$:
                                   1005 ;src/metasprites.c:258: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    000004F5 DD 4E FC         [19] 1006 	ld	c, -4 (ix)
    000004F8 DD 46 FD         [19] 1007 	ld	b, -3 (ix)
                                   1008 ;src/metasprites.c:257: DEVICE_SPRITE_PX_OFFSET_X + (PosX >> 4),
    000004FB DD 5E FE         [19] 1009 	ld	e, -2 (ix)
    000004FE DD 56 FF         [19] 1010 	ld	d, -1 (ix)
                                   1011 ;src/metasprites.c:254: TILE_NUM_START + get_tile_offset(0, 1),
    00000501 C5               [11] 1012 	push	bc
    00000502 D5               [11] 1013 	push	de
    00000503 2E 01            [ 7] 1014 	ld	l, #0x01
                                   1015 ;	spillPairReg hl
                                   1016 ;	spillPairReg hl
    00000505 AF               [ 4] 1017 	xor	a, a
    00000506 CDrD9r01         [17] 1018 	call	_get_tile_offset
    00000509 DD 77 FF         [19] 1019 	ld	-1 (ix), a
    0000050C D1               [10] 1020 	pop	de
    0000050D C1               [10] 1021 	pop	bc
                                   1022 ;src/metasprites.c:253: hiwater += move_metasprite_flipy( sprite_metasprites[idx],
    0000050E 3Ar09r00         [13] 1023 	ld	a, (_idx+0)
    00000511 26 00            [ 7] 1024 	ld	h, #0x00
                                   1025 ;	spillPairReg hl
                                   1026 ;	spillPairReg hl
    00000513 87               [ 4] 1027 	add	a, a
    00000514 CB 14            [ 8] 1028 	rl	h
    00000516 C6r00            [ 7] 1029 	add	a, #<(_sprite_metasprites)
    00000518 6F               [ 4] 1030 	ld	l, a
                                   1031 ;	spillPairReg hl
                                   1032 ;	spillPairReg hl
    00000519 7C               [ 4] 1033 	ld	a, h
    0000051A CEs00            [ 7] 1034 	adc	a, #>(_sprite_metasprites)
    0000051C 67               [ 4] 1035 	ld	h, a
                                   1036 ;	spillPairReg hl
                                   1037 ;	spillPairReg hl
    0000051D 7E               [ 7] 1038 	ld	a, (hl)
    0000051E 23               [ 6] 1039 	inc	hl
    0000051F 66               [ 7] 1040 	ld	h, (hl)
                                   1041 ;	spillPairReg hl
    00000520 6F               [ 4] 1042 	ld	l, a
                                   1043 ;	spillPairReg hl
                                   1044 ;	spillPairReg hl
                                   1045 ;src/metasprites.c:258: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
                                   1046 ;../../../include/sms/metasprites.h:149: __current_metasprite = metasprite;
    00000521 22r00r00         [16] 1047 	ld	(___current_metasprite), hl
                                   1048 ;../../../include/sms/metasprites.h:150: __current_base_tile = base_tile;
    00000524 DD 7E FF         [19] 1049 	ld	a, -1 (ix)
    00000527 32r00r00         [13] 1050 	ld	(___current_base_tile+0), a
                                   1051 ;../../../include/sms/metasprites.h:151: return __move_metasprite_flipy(base_sprite, x, y - ((__READ_VDP_REG(VDP_R1) & R1_SPR_8X16) ? 16 : 8) );
    0000052A 3Ar00r00         [13] 1052 	ld	a, (_shadow_VDP_R1+0)
    0000052D CB 4F            [ 8] 1053 	bit	1, a
                                   1054 ;	spillPairReg hl
                                   1055 ;	spillPairReg hl
                                   1056 ;	spillPairReg hl
                                   1057 ;	spillPairReg hl
    0000052F 2E 10            [ 7] 1058 	ld	l, #0x10
    00000531 20 02            [12] 1059 	jr	NZ, 00156$
    00000533 2E 08            [ 7] 1060 	ld	l, #0x08
    00000535                       1061 00156$:
    00000535 79               [ 4] 1062 	ld	a, c
    00000536 26 00            [ 7] 1063 	ld	h, #0x00
                                   1064 ;	spillPairReg hl
                                   1065 ;	spillPairReg hl
    00000538 95               [ 4] 1066 	sub	a, l
    00000539 4F               [ 4] 1067 	ld	c, a
    0000053A 78               [ 4] 1068 	ld	a, b
    0000053B 9C               [ 4] 1069 	sbc	a, h
    0000053C 47               [ 4] 1070 	ld	b, a
    0000053D C5               [11] 1071 	push	bc
    0000053E AF               [ 4] 1072 	xor	a, a
    0000053F CDr00r00         [17] 1073 	call	___move_metasprite_flipy
                                   1074 ;src/metasprites.c:258: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    00000542 DD 77 FF         [19] 1075 	ld	-1 (ix), a
                                   1076 ;src/metasprites.c:259: break;
    00000545 C3rC7r06         [10] 1077 	jp	00129$
                                   1078 ;src/metasprites.c:260: case 2:
    00000548                       1079 00126$:
                                   1080 ;src/metasprites.c:266: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    00000548 DD 4E FC         [19] 1081 	ld	c, -4 (ix)
    0000054B DD 46 FD         [19] 1082 	ld	b, -3 (ix)
                                   1083 ;src/metasprites.c:265: DEVICE_SPRITE_PX_OFFSET_X + (PosX >> 4),
    0000054E DD 5E FE         [19] 1084 	ld	e, -2 (ix)
    00000551 DD 56 FF         [19] 1085 	ld	d, -1 (ix)
                                   1086 ;src/metasprites.c:262: TILE_NUM_START + get_tile_offset(1, 1),
    00000554 C5               [11] 1087 	push	bc
    00000555 D5               [11] 1088 	push	de
                                   1089 ;	spillPairReg hl
                                   1090 ;	spillPairReg hl
    00000556 3E 01            [ 7] 1091 	ld	a,#0x01
    00000558 6F               [ 4] 1092 	ld	l,a
    00000559 CDrD9r01         [17] 1093 	call	_get_tile_offset
    0000055C DD 77 FF         [19] 1094 	ld	-1 (ix), a
    0000055F D1               [10] 1095 	pop	de
    00000560 C1               [10] 1096 	pop	bc
                                   1097 ;src/metasprites.c:261: hiwater += move_metasprite_flipxy(sprite_metasprites[idx],
    00000561 3Ar09r00         [13] 1098 	ld	a, (_idx+0)
    00000564 6F               [ 4] 1099 	ld	l, a
                                   1100 ;	spillPairReg hl
                                   1101 ;	spillPairReg hl
    00000565 26 00            [ 7] 1102 	ld	h, #0x00
                                   1103 ;	spillPairReg hl
                                   1104 ;	spillPairReg hl
    00000567 29               [11] 1105 	add	hl, hl
    00000568 7D               [ 4] 1106 	ld	a, l
    00000569 C6r00            [ 7] 1107 	add	a, #<(_sprite_metasprites)
    0000056B 6F               [ 4] 1108 	ld	l, a
                                   1109 ;	spillPairReg hl
                                   1110 ;	spillPairReg hl
    0000056C 7C               [ 4] 1111 	ld	a, h
    0000056D CEs00            [ 7] 1112 	adc	a, #>(_sprite_metasprites)
    0000056F 67               [ 4] 1113 	ld	h, a
                                   1114 ;	spillPairReg hl
                                   1115 ;	spillPairReg hl
    00000570 7E               [ 7] 1116 	ld	a, (hl)
    00000571 23               [ 6] 1117 	inc	hl
    00000572 66               [ 7] 1118 	ld	h, (hl)
                                   1119 ;	spillPairReg hl
    00000573 6F               [ 4] 1120 	ld	l, a
                                   1121 ;	spillPairReg hl
                                   1122 ;	spillPairReg hl
                                   1123 ;src/metasprites.c:266: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
                                   1124 ;../../../include/sms/metasprites.h:178: __current_metasprite = metasprite;
    00000574 22r00r00         [16] 1125 	ld	(___current_metasprite), hl
                                   1126 ;../../../include/sms/metasprites.h:179: __current_base_tile = base_tile;
    00000577 DD 7E FF         [19] 1127 	ld	a, -1 (ix)
    0000057A 32r00r00         [13] 1128 	ld	(___current_base_tile+0), a
                                   1129 ;../../../include/sms/metasprites.h:180: return __move_metasprite_flipxy(base_sprite, x - 8, y - ((__READ_VDP_REG(VDP_R1) & R1_SPR_8X16) ? 16 : 8));
    0000057D 3Ar00r00         [13] 1130 	ld	a, (_shadow_VDP_R1+0)
    00000580 CB 4F            [ 8] 1131 	bit	1, a
                                   1132 ;	spillPairReg hl
                                   1133 ;	spillPairReg hl
                                   1134 ;	spillPairReg hl
                                   1135 ;	spillPairReg hl
    00000582 2E 10            [ 7] 1136 	ld	l, #0x10
    00000584 20 02            [12] 1137 	jr	NZ, 00158$
    00000586 2E 08            [ 7] 1138 	ld	l, #0x08
    00000588                       1139 00158$:
    00000588 26 00            [ 7] 1140 	ld	h, #0x00
                                   1141 ;	spillPairReg hl
                                   1142 ;	spillPairReg hl
    0000058A 79               [ 4] 1143 	ld	a, c
    0000058B 95               [ 4] 1144 	sub	a, l
    0000058C 4F               [ 4] 1145 	ld	c, a
    0000058D 78               [ 4] 1146 	ld	a, b
    0000058E 9C               [ 4] 1147 	sbc	a, h
    0000058F 47               [ 4] 1148 	ld	b, a
    00000590 7B               [ 4] 1149 	ld	a, e
    00000591 C6 F8            [ 7] 1150 	add	a, #0xf8
    00000593 5F               [ 4] 1151 	ld	e, a
    00000594 7A               [ 4] 1152 	ld	a, d
    00000595 CE FF            [ 7] 1153 	adc	a, #0xff
    00000597 57               [ 4] 1154 	ld	d, a
    00000598 C5               [11] 1155 	push	bc
    00000599 AF               [ 4] 1156 	xor	a, a
    0000059A CDr00r00         [17] 1157 	call	___move_metasprite_flipxy
                                   1158 ;src/metasprites.c:266: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    0000059D DD 77 FF         [19] 1159 	ld	-1 (ix), a
                                   1160 ;src/metasprites.c:267: break;
    000005A0 C3rC7r06         [10] 1161 	jp	00129$
                                   1162 ;src/metasprites.c:268: case 3:
    000005A3                       1163 00127$:
                                   1164 ;src/metasprites.c:274: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    000005A3 DD 7E FC         [19] 1165 	ld	a, -4 (ix)
    000005A6 DD 77 F9         [19] 1166 	ld	-7 (ix), a
    000005A9 DD 7E FD         [19] 1167 	ld	a, -3 (ix)
    000005AC DD 77 FA         [19] 1168 	ld	-6 (ix), a
                                   1169 ;src/metasprites.c:273: DEVICE_SPRITE_PX_OFFSET_X + (PosX >> 4),
    000005AF DD 7E FE         [19] 1170 	ld	a, -2 (ix)
    000005B2 DD 77 FB         [19] 1171 	ld	-5 (ix), a
    000005B5 DD 7E FF         [19] 1172 	ld	a, -1 (ix)
    000005B8 DD 77 FC         [19] 1173 	ld	-4 (ix), a
                                   1174 ;src/metasprites.c:270: TILE_NUM_START + get_tile_offset(1, 0),
    000005BB 2E 00            [ 7] 1175 	ld	l, #0x00
                                   1176 ;	spillPairReg hl
                                   1177 ;	spillPairReg hl
    000005BD 3E 01            [ 7] 1178 	ld	a, #0x01
    000005BF CDrD9r01         [17] 1179 	call	_get_tile_offset
    000005C2 DD 77 FD         [19] 1180 	ld	-3 (ix), a
                                   1181 ;src/metasprites.c:269: hiwater += move_metasprite_flipx( sprite_metasprites[idx],
    000005C5 3Ar09r00         [13] 1182 	ld	a, (_idx+0)
    000005C8 DD 77 FE         [19] 1183 	ld	-2 (ix), a
    000005CB DD 36 FF 00      [19] 1184 	ld	-1 (ix), #0x00
    000005CF DD 7E FE         [19] 1185 	ld	a, -2 (ix)
    000005D2 DD 77 F7         [19] 1186 	ld	-9 (ix), a
    000005D5 DD 36 F8 00      [19] 1187 	ld	-8 (ix), #0x00
    000005D9 DD CB F7 26      [23] 1188 	sla	-9 (ix)
    000005DD DD CB F8 16      [23] 1189 	rl	-8 (ix)
    000005E1 DD 7E F7         [19] 1190 	ld	a, -9 (ix)
    000005E4 C6r00            [ 7] 1191 	add	a, #<(_sprite_metasprites)
    000005E6 DD 77 FE         [19] 1192 	ld	-2 (ix), a
    000005E9 DD 7E F8         [19] 1193 	ld	a, -8 (ix)
    000005EC CEs00            [ 7] 1194 	adc	a, #>(_sprite_metasprites)
    000005EE DD 77 FF         [19] 1195 	ld	-1 (ix), a
    000005F1 DD 6E FE         [19] 1196 	ld	l, -2 (ix)
    000005F4 DD 66 FF         [19] 1197 	ld	h, -1 (ix)
    000005F7 7E               [ 7] 1198 	ld	a, (hl)
    000005F8 DD 77 FE         [19] 1199 	ld	-2 (ix), a
    000005FB 23               [ 6] 1200 	inc	hl
    000005FC 7E               [ 7] 1201 	ld	a, (hl)
    000005FD DD 77 FF         [19] 1202 	ld	-1 (ix), a
                                   1203 ;../../../include/sms/metasprites.h:120: __current_metasprite = metasprite;
    00000600 DD 6E FE         [19] 1204 	ld	l, -2 (ix)
    00000603 DD 66 FF         [19] 1205 	ld	h, -1 (ix)
    00000606 22r00r00         [16] 1206 	ld	(___current_metasprite), hl
                                   1207 ;../../../include/sms/metasprites.h:121: __current_base_tile = base_tile;
    00000609 DD 7E FD         [19] 1208 	ld	a, -3 (ix)
    0000060C 32r00r00         [13] 1209 	ld	(___current_base_tile+0), a
                                   1210 ;../../../include/sms/metasprites.h:122: return __move_metasprite_flipx(base_sprite, x - 8, y);
    0000060F DD 7E FB         [19] 1211 	ld	a, -5 (ix)
    00000612 DD 77 FE         [19] 1212 	ld	-2 (ix), a
    00000615 DD 7E FC         [19] 1213 	ld	a, -4 (ix)
    00000618 DD 77 FF         [19] 1214 	ld	-1 (ix), a
    0000061B DD 7E FE         [19] 1215 	ld	a, -2 (ix)
    0000061E C6 F8            [ 7] 1216 	add	a, #0xf8
    00000620 DD 77 FC         [19] 1217 	ld	-4 (ix), a
    00000623 DD 7E FF         [19] 1218 	ld	a, -1 (ix)
    00000626 CE FF            [ 7] 1219 	adc	a, #0xff
    00000628 DD 77 FD         [19] 1220 	ld	-3 (ix), a
    0000062B DD 7E FC         [19] 1221 	ld	a, -4 (ix)
    0000062E DD 77 FE         [19] 1222 	ld	-2 (ix), a
    00000631 DD 7E FD         [19] 1223 	ld	a, -3 (ix)
    00000634 DD 77 FF         [19] 1224 	ld	-1 (ix), a
    00000637 D1               [10] 1225 	pop	de
    00000638 E1               [10] 1226 	pop	hl
    00000639 E5               [11] 1227 	push	hl
    0000063A D5               [11] 1228 	push	de
    0000063B E5               [11] 1229 	push	hl
    0000063C DD 5E FE         [19] 1230 	ld	e, -2 (ix)
    0000063F DD 56 FF         [19] 1231 	ld	d, -1 (ix)
    00000642 AF               [ 4] 1232 	xor	a, a
    00000643 CDr00r00         [17] 1233 	call	___move_metasprite_flipx
    00000646 DD 77 FF         [19] 1234 	ld	-1 (ix), a
                                   1235 ;src/metasprites.c:275: break;
    00000649 18 7C            [12] 1236 	jr	00129$
                                   1237 ;src/metasprites.c:276: default:
    0000064B                       1238 00128$:
                                   1239 ;src/metasprites.c:282: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    0000064B DD 7E FC         [19] 1240 	ld	a, -4 (ix)
    0000064E DD 77 F9         [19] 1241 	ld	-7 (ix), a
    00000651 DD 7E FD         [19] 1242 	ld	a, -3 (ix)
    00000654 DD 77 FA         [19] 1243 	ld	-6 (ix), a
                                   1244 ;src/metasprites.c:281: DEVICE_SPRITE_PX_OFFSET_X + (PosX >> 4),
    00000657 DD 7E FE         [19] 1245 	ld	a, -2 (ix)
    0000065A DD 77 FB         [19] 1246 	ld	-5 (ix), a
    0000065D DD 7E FF         [19] 1247 	ld	a, -1 (ix)
    00000660 DD 77 FC         [19] 1248 	ld	-4 (ix), a
                                   1249 ;src/metasprites.c:278: TILE_NUM_START + get_tile_offset(0, 0),
                                   1250 ;	spillPairReg hl
                                   1251 ;	spillPairReg hl
    00000663 AF               [ 4] 1252 	xor	a, a
    00000664 6F               [ 4] 1253 	ld	l, a
    00000665 CDrD9r01         [17] 1254 	call	_get_tile_offset
    00000668 DD 77 FD         [19] 1255 	ld	-3 (ix), a
                                   1256 ;src/metasprites.c:277: hiwater += move_metasprite_ex(    sprite_metasprites[idx],
    0000066B 3Ar09r00         [13] 1257 	ld	a, (_idx+0)
    0000066E DD 77 FE         [19] 1258 	ld	-2 (ix), a
    00000671 DD 36 FF 00      [19] 1259 	ld	-1 (ix), #0x00
    00000675 DD 7E FE         [19] 1260 	ld	a, -2 (ix)
    00000678 DD 77 F7         [19] 1261 	ld	-9 (ix), a
    0000067B DD 36 F8 00      [19] 1262 	ld	-8 (ix), #0x00
    0000067F DD CB F7 26      [23] 1263 	sla	-9 (ix)
    00000683 DD CB F8 16      [23] 1264 	rl	-8 (ix)
    00000687 DD 7E F7         [19] 1265 	ld	a, -9 (ix)
    0000068A C6r00            [ 7] 1266 	add	a, #<(_sprite_metasprites)
    0000068C DD 77 FE         [19] 1267 	ld	-2 (ix), a
    0000068F DD 7E F8         [19] 1268 	ld	a, -8 (ix)
    00000692 CEs00            [ 7] 1269 	adc	a, #>(_sprite_metasprites)
    00000694 DD 77 FF         [19] 1270 	ld	-1 (ix), a
    00000697 DD 6E FE         [19] 1271 	ld	l, -2 (ix)
    0000069A DD 66 FF         [19] 1272 	ld	h, -1 (ix)
    0000069D 7E               [ 7] 1273 	ld	a, (hl)
    0000069E DD 77 FE         [19] 1274 	ld	-2 (ix), a
    000006A1 23               [ 6] 1275 	inc	hl
    000006A2 7E               [ 7] 1276 	ld	a, (hl)
    000006A3 DD 77 FF         [19] 1277 	ld	-1 (ix), a
                                   1278 ;../../../include/sms/metasprites.h:83: __current_metasprite = metasprite;
    000006A6 DD 6E FE         [19] 1279 	ld	l, -2 (ix)
    000006A9 DD 66 FF         [19] 1280 	ld	h, -1 (ix)
    000006AC 22r00r00         [16] 1281 	ld	(___current_metasprite), hl
                                   1282 ;../../../include/sms/metasprites.h:84: __current_base_tile = base_tile;
    000006AF DD 7E FD         [19] 1283 	ld	a, -3 (ix)
    000006B2 32r00r00         [13] 1284 	ld	(___current_base_tile+0), a
                                   1285 ;../../../include/sms/metasprites.h:85: return __move_metasprite(base_sprite, x, y);
    000006B5 D1               [10] 1286 	pop	de
    000006B6 E1               [10] 1287 	pop	hl
    000006B7 E5               [11] 1288 	push	hl
    000006B8 D5               [11] 1289 	push	de
    000006B9 E5               [11] 1290 	push	hl
    000006BA DD 5E FB         [19] 1291 	ld	e, -5 (ix)
    000006BD DD 56 FC         [19] 1292 	ld	d, -4 (ix)
    000006C0 AF               [ 4] 1293 	xor	a, a
    000006C1 CDr00r00         [17] 1294 	call	___move_metasprite
    000006C4 DD 77 FF         [19] 1295 	ld	-1 (ix), a
                                   1296 ;src/metasprites.c:284: }
    000006C7                       1297 00129$:
                                   1298 ;src/metasprites.c:287: hide_sprites_range(hiwater, MAX_HARDWARE_SPRITES);        
    000006C7 2E 40            [ 7] 1299 	ld	l, #0x40
                                   1300 ;	spillPairReg hl
                                   1301 ;	spillPairReg hl
    000006C9 DD 7E FF         [19] 1302 	ld	a, -1 (ix)
    000006CC CDr00r00         [17] 1303 	call	_hide_sprites_range
                                   1304 ;src/metasprites.c:290: if (!(PosF & ACC_Y)) {
    000006CF 3Ar08r00         [13] 1305 	ld	a, (_PosF+0)
    000006D2 4F               [ 4] 1306 	ld	c, a
    000006D3 CB 49            [ 8] 1307 	bit	1, c
    000006D5 20 2A            [12] 1308 	jr	NZ, 00136$
                                   1309 ;src/metasprites.c:291: if (SpdY != 0) {
    000006D7 3Ar07r00         [13] 1310 	ld	a, (_SpdY+1)
    000006DA FD 21r06r00      [14] 1311 	ld	iy, #_SpdY
    000006DE FD B6 00         [19] 1312 	or	a, 0 (iy)
    000006E1 28 1E            [12] 1313 	jr	Z, 00136$
                                   1314 ;src/metasprites.c:292: if (SpdY > 0) SpdY--;
    000006E3 2Ar06r00         [16] 1315 	ld	hl, (_SpdY)
    000006E6 AF               [ 4] 1316 	xor	a, a
    000006E7 BD               [ 4] 1317 	cp	a, l
    000006E8 9C               [ 4] 1318 	sbc	a, h
    000006E9 E2rEEr06         [10] 1319 	jp	PO, 00338$
    000006EC EE 80            [ 7] 1320 	xor	a, #0x80
    000006EE                       1321 00338$:
    000006EE F2rFAr06         [10] 1322 	jp	P, 00131$
    000006F1 2Ar06r00         [16] 1323 	ld	hl, (_SpdY)
    000006F4 2B               [ 6] 1324 	dec	hl
    000006F5 22r06r00         [16] 1325 	ld	(_SpdY), hl
    000006F8 18 07            [12] 1326 	jr	00136$
    000006FA                       1327 00131$:
                                   1328 ;src/metasprites.c:293: else SpdY ++;
    000006FA 2Ar06r00         [16] 1329 	ld	hl, (_SpdY)
    000006FD 23               [ 6] 1330 	inc	hl
    000006FE 22r06r00         [16] 1331 	ld	(_SpdY), hl
    00000701                       1332 00136$:
                                   1333 ;src/metasprites.c:298: if (!(PosF & ACC_X)) {
    00000701 CB 41            [ 8] 1334 	bit	0, c
    00000703 20 2A            [12] 1335 	jr	NZ, 00143$
                                   1336 ;src/metasprites.c:299: if (SpdX != 0) {
    00000705 3Ar05r00         [13] 1337 	ld	a, (_SpdX+1)
    00000708 FD 21r04r00      [14] 1338 	ld	iy, #_SpdX
    0000070C FD B6 00         [19] 1339 	or	a, 0 (iy)
    0000070F 28 1E            [12] 1340 	jr	Z, 00143$
                                   1341 ;src/metasprites.c:300: if (SpdX > 0) SpdX--;
    00000711 2Ar04r00         [16] 1342 	ld	hl, (_SpdX)
    00000714 AF               [ 4] 1343 	xor	a, a
    00000715 BD               [ 4] 1344 	cp	a, l
    00000716 9C               [ 4] 1345 	sbc	a, h
    00000717 E2r1Cr07         [10] 1346 	jp	PO, 00341$
    0000071A EE 80            [ 7] 1347 	xor	a, #0x80
    0000071C                       1348 00341$:
    0000071C F2r28r07         [10] 1349 	jp	P, 00138$
    0000071F 2Ar04r00         [16] 1350 	ld	hl, (_SpdX)
    00000722 2B               [ 6] 1351 	dec	hl
    00000723 22r04r00         [16] 1352 	ld	(_SpdX), hl
    00000726 18 07            [12] 1353 	jr	00143$
    00000728                       1354 00138$:
                                   1355 ;src/metasprites.c:301: else SpdX ++;
    00000728 2Ar04r00         [16] 1356 	ld	hl, (_SpdX)
    0000072B 23               [ 6] 1357 	inc	hl
    0000072C 22r04r00         [16] 1358 	ld	(_SpdX), hl
    0000072F                       1359 00143$:
                                   1360 ;src/metasprites.c:307: vsync();
    0000072F CDr00r00         [17] 1361 	call	_vsync
                                   1362 ;src/metasprites.c:309: }
    00000732 C3r2Br03         [10] 1363 	jp	00145$
    00000735                       1364 _gray_pal:
    00000735 FF 0F                 1365 	.dw #0x0fff
    00000737 AA 0A                 1366 	.dw #0x0aaa
    00000739 55 05                 1367 	.dw #0x0555
    0000073B 00 00                 1368 	.dw #0x0000
    0000073D                       1369 _pink_pal:
    0000073D FF 0F                 1370 	.dw #0x0fff
    0000073F 0F 0F                 1371 	.dw #0x0f0f
    00000741 0A 0A                 1372 	.dw #0x0a0a
    00000743 05 05                 1373 	.dw #0x0505
    00000745                       1374 _cyan_pal:
    00000745 FF 0F                 1375 	.dw #0x0fff
    00000747 F5 0F                 1376 	.dw #0x0ff5
    00000749 A0 0A                 1377 	.dw #0x0aa0
    0000074B 50 05                 1378 	.dw #0x0550
    0000074D                       1379 _green_pal:
    0000074D FF 0F                 1380 	.dw #0x0fff
    0000074F FA 0A                 1381 	.dw #0x0afa
    00000751 A0 00                 1382 	.dw #0x00a0
    00000753 50 00                 1383 	.dw #0x0050
                                   1384 	.area _CODE
                                   1385 	.area _INITIALIZER
    00000000                       1386 __xinit__joyp:
    00000000 00                    1387 	.db #0x00	; 0
    00000001                       1388 __xinit__old_joyp:
    00000001 00                    1389 	.db #0x00	; 0
                                   1390 	.area _CABS (ABS)
